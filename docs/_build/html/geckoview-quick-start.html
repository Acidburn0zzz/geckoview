
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title># GeckoView Contributor Quick Start Guide &#8212; GeckoView 66 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="# Submitting a patch to Firefox using Git." href="contributing-to-mc.html" />
    <link rel="prev" title="Welcome to GeckoView’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="geckoview-contributor-quick-start-guide">
<h1># GeckoView Contributor Quick Start Guide<a class="headerlink" href="#geckoview-contributor-quick-start-guide" title="Permalink to this headline">¶</a></h1>
<p>This is a guide for developers who want to contribute to the GeckoView project. If you want to get started using GeckoView in your app then you should refer to the [wiki](<a class="reference external" href="https://wiki.mozilla.org/Mobile/GeckoView#Get_Started">https://wiki.mozilla.org/Mobile/GeckoView#Get_Started</a>).</p>
<p>You may also be interested in how to get up and running with [Firefox For Android(<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Mozilla/Developer_guide/Build_Instructions/Simple_Firefox_for_Android_build">https://developer.mozilla.org/en-US/docs/Mozilla/Developer_guide/Build_Instructions/Simple_Firefox_for_Android_build</a>).</p>
<p>## Get set up with Mozilla Central</p>
<p>The GeckoView codebase is part of the main Firefox tree and can be found in <cite>mozilla-central</cite>. You will need to get set up as a contributor to Firefox in order to contribute to GeckoView. To get set up with <cite>mozilla-central</cite>, follow the [Quick Start Guide for Git Users](MozCentralQuickStart.md), or the [Contributing to the Mozilla code base](<a class="reference external" href="https://developer.mozilla.org/docs/Mozilla/Developer_guide/Introduction">https://developer.mozilla.org/docs/Mozilla/Developer_guide/Introduction</a>) guide on [MDN](<a class="reference external" href="https://developer.mozilla.org/">https://developer.mozilla.org/</a>) for Mercurial users.</p>
<p>Once you have a copy of <cite>mozilla-central</cite>, you will need to build GeckoView.</p>
<p>## Bootstrap Gecko
Bootstrap configures everything for GeckoView and Fennec development.</p>
<ul class="simple">
<li>Ensure you have <cite>mozilla-central</cite> checked out. If this is the first time you are doing this, it may take some time.</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git checkout central/default
</pre></div>
</div>
<p>If you are on a mac, you will need to have the Xcode build tools installed. You can do this by either [installing Xcode](<a class="reference external" href="https://developer.apple.com/xcode/">https://developer.apple.com/xcode/</a>) or installing only the tools from the command line by running <cite>xcode-select –install</cite> and following the on screen instructions. Use the ` –no-interactive` argument to automatically accept any license agreements.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./mach bootstrap <span class="o">[</span> --no-interactive<span class="o">]</span>
</pre></div>
</div>
<ul class="simple">
<li>Choose option <cite>4. Firefox for Android</cite> for GeckoView development. This will give you a version of Gecko configured for Android that has not bundled the native code into embedded libraries so you can amend the code.</li>
<li>Say Y to all configuration options</li>
<li>Once <cite>mach bootstrap</cite> is complete it will tell you to copy and paste some configuration into your <cite>mozconfig</cite> file. The <cite>mozconfig</cite> file can be found in the root of your <cite>gecko</cite> repo - or create a file called <cite>mozconfig</cite> if it does not exist. Check that the correct value is associated with the <cite>–target</cite> argument as this may not correctly match your setup. Your <cite>mozconfig</cite> should read something like this:</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mk_add_options <span class="nv">MOZ_OBJDIR</span><span class="o">=</span>../objdir-android-opt

<span class="c1"># Build Firefox for Android:</span>
ac_add_options --enable-application<span class="o">=</span>mobile/android
ac_add_options --target<span class="o">=</span>&lt;your target architecture&gt;

<span class="c1"># With the following java and javac:</span>
ac_add_options --with-java-bin-path<span class="o">=</span><span class="s2">&quot;/Library/Java/Home/bin&quot;</span>

<span class="c1"># With the following Android SDK and NDK:</span>
ac_add_options --with-android-sdk<span class="o">=</span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/.mozbuild/&lt;your-sdk&gt;&quot;</span>
ac_add_options --with-android-ndk<span class="o">=</span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/.mozbuild/android-ndk-r17b&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li>Configure your build.</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./mach configure
</pre></div>
</div>
<p>## Build from the command line</p>
<p>In order to pick up the configuration changes we just made we need to build from the command line and package the app.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./mach build
./mach package
</pre></div>
</div>
<p>## Build Using Android Studio</p>
<ul>
<li><p class="first">Install [Android Studio](<a class="reference external" href="https://developer.android.com/studio/install">https://developer.android.com/studio/install</a>).</p>
</li>
<li><p class="first">Disable Instant Run. This is because Fennec and the Geckoview Example app cannot deploy with Instant Run on.</p>
<ul class="simple">
<li>Select Android Studio &gt; Preferences from the menu bar</li>
<li>Navigate to Build, Execution, Deployment &gt; Instant Run.</li>
<li>Uncheck the box that reads <cite>Enable Instant Run to hot swap code/resource changes on deploy</cite>.</li>
</ul>
<p>![alt text](assets/DisableInstantRun.png “Disable Instant Run”)</p>
</li>
<li><p class="first">Choose File-&gt;Open from the toolbar</p>
</li>
<li><p class="first">Navigate to &lt;path to gecko&gt;/mobile/android/geckoview and click “Open”</p>
</li>
<li><p class="first">Click yes if it asks if you want to use the gradle wrapper.</p>
</li>
<li><p class="first">Wait for the project to index and gradle to sync. Once synced, the workspace will reconfigure to display the different projects.</p>
<ul class="simple">
<li>annotations contains custom annotations used inside GeckoView and Fennec.</li>
<li>app is Fennec - Firefox for Android. Here is where you will find code specific to that app.</li>
<li>geckoview is the GeckoView project. Here is all the Java files related to GeckoView</li>
<li>geckoview_example is an example browser built using GeckoView.</li>
<li>omnijar contains the parts of Gecko and GeckoView that are not written in Java or Kotlin</li>
<li>thirdparty contains third party code that Fennec and GeckoView use.</li>
</ul>
<p>![alt text](assets/GeckoViewStructure.png “GeckoView Structure”)</p>
</li>
</ul>
<p>Now you’re set up and ready to go.</p>
<p>## Performing a bug fix</p>
<p>One you have got GeckoView building and running, you will want to start contributing. There is a general guide to [Performing a Bug Fix for Git Developers](ContributingToMC.md) for you to follow. To contribute to GeckoView specifically, you will need the following additional information.</p>
<p>It is advisable to run your tests before submitting your patch. You can do this using Mozilla’s <cite>try</cite> server. To submit a GeckoView patch to <cite>try</cite> before submitting it for review, type:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./mach try fuzzy -q <span class="s2">&quot;android&quot;</span>
</pre></div>
</div>
<p>This will run all of the Android test suite. If your patch passes on <cite>try</cite> you can be (fairly) confident that it will land successfully after review.</p>
<p>When submitting a patch to Phabricator, if you know who you want to review your patch, put their Phabricator handle against the <cite>reviewers</cite> field.</p>
<p>If you don’t know who to tag for a review in the Phabricator submission message, leave the field blank and, after submission, follow the link to the patch in Phabricator and scroll to the bottom of the screen until you see the comment box.</p>
<blockquote>
<div><ul class="simple">
<li>Select the <cite>Add Action</cite> drop down and pick the <cite>Change Reviewers</cite> option.</li>
<li>In the presented box, add <cite>geckoview-reviewers</cite>. Selecting this group as the reviewer will notify all the members of the GeckoView team there is a patch to review.</li>
<li>Click <cite>Submit</cite> to submit the reviewer change request.</li>
</ul>
</div></blockquote>
<p>## Include GeckoView as a dependency</p>
<p>If you want to include a development version of GeckoView as a dependency inside another app, you must link to a local copy. There are two ways of doing this, publishing GeckoView to a local Maven repository (recommended), or linking to a local archive/</p>
<p>### Public to a local repository</p>
<p>Publish GeckoView to your local maven by running</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./gradlew geckoview:publishWithGeckoBinariesDebugPublicationToMavenLocal
</pre></div>
</div>
<ul class="simple">
<li>The binary will have been published to a repo found in <cite>~/.m2</cite>. Run the following command to figure out the name of the artifcat:</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tree ~/.m2/repository/org/mozilla/geckoview
</pre></div>
</div>
<ul class="simple">
<li>Make a note of the name of your artifact. Update your gradle file to point to the dependency and link to your local repository.</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dependencies</span> <span class="p">{</span>
    <span class="o">//</span> <span class="o">...</span>
    <span class="n">armImplementation</span> <span class="s2">&quot;geckoview-nightly-armeabi-v7a-65.0.20181128102620&quot;</span>
    <span class="o">//</span> <span class="o">...</span>
<span class="p">}</span>

<span class="o">//</span> <span class="o">...</span>

<span class="n">repositories</span> <span class="p">{</span>
  <span class="o">//...</span>
  <span class="n">mavenLocal</span><span class="p">()</span>
  <span class="o">//..</span>
<span class="p">}</span>
</pre></div>
</div>
<p>### Archive GeckoView</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./mach android archive-geckoview
</pre></div>
</div>
<p>This should create a file named geckoview-*.aar in your build output folder (MOZ_OBJDIR):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ls &lt;your-output-directory&gt;/gradle/build/mobile/android/geckoview/outputs/aar
geckoview-official-withGeckoBinaries-noMinApi-release.aar
</pre></div>
</div>
<p>Then all you need to do is point to the AAR in your gradle file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">repositories</span> <span class="p">{</span>
    <span class="o">//</span> <span class="o">...</span>

    <span class="n">flatDir</span><span class="p">(</span>
        <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;localBuild&#39;</span><span class="p">,</span>
        <span class="n">dirs</span><span class="p">:</span> <span class="s1">&#39;&lt;absolute path to AAR&gt;&#39;</span>
    <span class="p">)</span>
<span class="p">}</span>
<span class="o">//</span> <span class="o">...</span>
<span class="n">dependencies</span> <span class="p">{</span>
    <span class="o">//</span> <span class="o">...</span>

    <span class="o">//</span> <span class="n">armImplementation</span> <span class="s2">&quot;org.mozilla:geckoview-nightly-armeabi-v7a:60.0a1&quot;</span>
    <span class="n">armImplementation</span> <span class="p">(</span>
            <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;geckoview-official-withGeckoBinaries-noMinApi-release&#39;</span><span class="p">,</span>
            <span class="n">ext</span><span class="p">:</span> <span class="s1">&#39;aar&#39;</span>
    <span class="p">)</span>
    <span class="n">x86Implementation</span> <span class="s2">&quot;org.mozilla:geckoview-nightly-x86:60.0a1&quot;</span>

    <span class="o">//</span> <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">GeckoView</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#"># GeckoView Contributor Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing-to-mc.html"># Submitting a patch to Firefox using Git.</a></li>
<li class="toctree-l1"><a class="reference internal" href="moz-central-quick-start.html"># Firefox Developer Git Quick Start Guide</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to GeckoView’s documentation!</a></li>
      <li>Next: <a href="contributing-to-mc.html" title="next chapter"># Submitting a patch to Firefox using Git.</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Mozilla.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/geckoview-quick-start.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>